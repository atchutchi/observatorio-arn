{% extends "questionarios/partials/base_form.html" %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/trafego_originado.css' %}">
{% endblock %}

{% block form_title %}{% if form.instance.pk %}Editar{% else %}Criar{% endif %} Indicador de Tráfego Originado{% endblock %}
{% block form_subtitle %}Indicadores KPI ARN - Seção 5: Tráfego Originado{% endblock %}

{% block list_url %}{% url 'questionarios:trafego_originado_list' %}{% endblock %}

{% block form_fields %}
<!-- SEÇÃO 5.1: TRÁFEGO DE DADOS -->
<div class="platform-card mb-4">
    <div class="card-header">
        <h4 class="card-title">
            <i class="fas fa-database me-2"></i>
            5.1 Tráfego de Dados
        </h4>
    </div>
    <div class="card-body">
        <!-- 5.1.1 Dados 2G -->
        <h6 style="color: var(--binance-yellow);">5.1.1 Tráfego de Dados das Redes 2G</h6>
        <div class="row mb-4">
            <div class="col-md-6">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.1.1 Volume 2G (MBytes)</label>
                    {{ form.trafego_dados_2g_mbytes }}
                    <small class="form-text text-muted">Volume total em MBytes</small>
                    {% if form.trafego_dados_2g_mbytes.errors %}
                        <div class="invalid-feedback d-block">
                            {% for error in form.trafego_dados_2g_mbytes.errors %}{{ error }}{% endfor %}
                        </div>
                    {% endif %}
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.1.1.a Sessões 2G</label>
                    {{ form.trafego_dados_2g_sessoes }}
                    <small class="form-text text-muted">Número de sessões</small>
                    {% if form.trafego_dados_2g_sessoes.errors %}
                        <div class="invalid-feedback d-block">
                            {% for error in form.trafego_dados_2g_sessoes.errors %}{{ error }}{% endfor %}
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <!-- 5.1.2 Dados 3G -->
        <h6 style="color: var(--binance-success);">5.1.2 Tráfego de Dados das Redes 3G e Upgrades</h6>
        <div class="row mb-4">
            <div class="col-md-6">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.1.2 Volume 3G Total (MBytes)</label>
                    {{ form.trafego_dados_3g_upgrade_mbytes }}
                    {% if form.trafego_dados_3g_upgrade_mbytes.errors %}
                        <div class="invalid-feedback d-block">
                            {% for error in form.trafego_dados_3g_upgrade_mbytes.errors %}{{ error }}{% endfor %}
                        </div>
                    {% endif %}
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.1.2.a Sessões 3G Total</label>
                    {{ form.trafego_dados_3g_upgrade_sessoes }}
                    {% if form.trafego_dados_3g_upgrade_sessoes.errors %}
                        <div class="invalid-feedback d-block">
                            {% for error in form.trafego_dados_3g_upgrade_sessoes.errors %}{{ error }}{% endfor %}
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.1.2.1 Internet 3G</label>
                    {{ form.internet_3g_mbytes }}
                    <small class="form-text text-muted">MBytes</small>
                </div>
            </div>
            <div class="col-md-3">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.1.2.1.a Sessões</label>
                    {{ form.internet_3g_sessoes }}
                </div>
            </div>
            <div class="col-md-3">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.1.2.1.p Placas/Box</label>
                    {{ form.internet_3g_placas_modem_mbytes }}
                    <small class="form-text text-muted">MBytes</small>
                </div>
            </div>
            <div class="col-md-3">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.1.2.1.q USB</label>
                    {{ form.internet_3g_modem_usb_mbytes }}
                    <small class="form-text text-muted">MBytes</small>
                </div>
            </div>
        </div>
        
        <!-- 5.1.3 Dados 4G -->
        <h6 style="color: var(--binance-info);">5.1.3 Tráfego de Dados das Redes 4G/LTE</h6>
        <div class="row mb-4">
            <div class="col-md-6">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.1.3 Volume 4G Total (MBytes)</label>
                    {{ form.trafego_dados_4g_mbytes }}
                    {% if form.trafego_dados_4g_mbytes.errors %}
                        <div class="invalid-feedback d-block">
                            {% for error in form.trafego_dados_4g_mbytes.errors %}{{ error }}{% endfor %}
                        </div>
                    {% endif %}
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.1.3.a Sessões 4G Total</label>
                    {{ form.trafego_dados_4g_sessoes }}
                    {% if form.trafego_dados_4g_sessoes.errors %}
                        <div class="invalid-feedback d-block">
                            {% for error in form.trafego_dados_4g_sessoes.errors %}{{ error }}{% endfor %}
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-3">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.1.3.1 Internet 4G</label>
                    {{ form.internet_4g_mbytes }}
                    <small class="form-text text-muted">MBytes</small>
                </div>
            </div>
            <div class="col-md-3">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.1.3.1.a Sessões</label>
                    {{ form.internet_4g_sessoes }}
                </div>
            </div>
            <div class="col-md-3">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.1.3.1.p Placas/Box</label>
                    {{ form.internet_4g_placas_modem_mbytes }}
                    <small class="form-text text-muted">MBytes</small>
                </div>
            </div>
            <div class="col-md-3">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.1.3.1.q USB</label>
                    {{ form.internet_4g_modem_usb_mbytes }}
                    <small class="form-text text-muted">MBytes</small>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- SEÇÃO 5.2: TRÁFEGO DE MENSAGENS (SMS) -->
<div class="platform-card mb-4">
    <div class="card-header">
        <h4 class="card-title">
            <i class="fas fa-sms me-2"></i>
            5.2 Tráfego de Mensagens (SMS)
        </h4>
    </div>
    <div class="card-body">
        <!-- Nacional -->
        <h6 style="color: var(--binance-yellow);">5.2.1 e 5.2.2 SMS Nacional</h6>
        <div class="row mb-4">
            <div class="col-md-4">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.2 Total SMS</label>
                    {{ form.sms_total }}
                    <small class="form-text text-muted">Calculado automaticamente</small>
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.2.1 On-net</label>
                    {{ form.sms_on_net }}
                    <small class="form-text text-muted">Mesma rede</small>
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.2.2 Off-net Nacional</label>
                    {{ form.sms_off_net_nacional }}
                    <small class="form-text text-muted">Outras redes nacionais</small>
                </div>
            </div>
        </div>
        
        <!-- Internacional -->
        <h6 style="color: var(--binance-warning);">5.2.3 SMS Internacional</h6>
        <div class="row">
            <div class="col-md-4">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.2.3 Total Internacional</label>
                    {{ form.sms_internacional_total }}
                    <small class="form-text text-muted">Calculado automaticamente</small>
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.2.3.1 CEDEAO</label>
                    {{ form.sms_cedeao }}
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.2.3.2 PALOP</label>
                    {{ form.sms_palop }}
                </div>
            </div>
        </div>
        <div class="row mt-3">
            <div class="col-md-4">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.2.3.3 CPLP</label>
                    {{ form.sms_cplp }}
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.2.3.4 Resto África</label>
                    {{ form.sms_resto_africa }}
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.2.3.5 Resto Mundo</label>
                    {{ form.sms_resto_mundo }}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- SEÇÃO 5.3: VOLUME DE TRÁFEGO DE VOZ (MINUTOS) -->
<div class="platform-card mb-4">
    <div class="card-header">
        <h4 class="card-title">
            <i class="fas fa-phone-alt me-2"></i>
            5.3 Volume de Tráfego de Voz (Minutos)
        </h4>
    </div>
    <div class="card-body">
        <!-- Nacional -->
        <h6 style="color: var(--binance-yellow);">5.3.1 e 5.3.2 Voz Nacional</h6>
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.3 Total Minutos</label>
                    {{ form.voz_total_minutos }}
                    <small class="form-text text-muted">Calculado</small>
                </div>
            </div>
            <div class="col-md-3">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.3.1 On-net</label>
                    {{ form.voz_on_net_minutos }}
                </div>
            </div>
            <div class="col-md-3">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.3.2 Off-net</label>
                    {{ form.voz_off_net_nacional_minutos }}
                </div>
            </div>
            <div class="col-md-3">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.3.2.1 Rede Fixa</label>
                    {{ form.voz_rede_fixa_minutos }}
                </div>
            </div>
        </div>
        
        <!-- Internacional -->
        <h6 style="color: var(--binance-warning);">5.3.3 Voz Internacional</h6>
        <div class="row">
            <div class="col-md-4">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.3.3 Total Internacional</label>
                    {{ form.voz_internacional_total_minutos }}
                    <small class="form-text text-muted">Calculado</small>
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.3.3.1 CEDEAO</label>
                    {{ form.voz_cedeao_minutos }}
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.3.3.2 PALOP</label>
                    {{ form.voz_palop_minutos }}
                </div>
            </div>
        </div>
        <div class="row mt-3">
            <div class="col-md-4">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.3.3.3 CPLP</label>
                    {{ form.voz_cplp_minutos }}
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.3.3.4 Resto África</label>
                    {{ form.voz_resto_africa_minutos }}
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.3.3.5 Resto Mundo</label>
                    {{ form.voz_resto_mundo_minutos }}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- SEÇÃO 5.4: NÚMERO DE COMUNICAÇÕES DE VOZ (CHAMADAS) -->
<div class="platform-card mb-4">
    <div class="card-header">
        <h4 class="card-title">
            <i class="fas fa-phone-volume me-2"></i>
            5.4 Número de Comunicações de Voz (Chamadas)
        </h4>
    </div>
    <div class="card-body">
        <!-- Nacional -->
        <h6 style="color: var(--binance-yellow);">5.4.1 e 5.4.2 Chamadas Nacionais</h6>
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.4 Total Chamadas</label>
                    {{ form.chamadas_total }}
                    <small class="form-text text-muted">Calculado</small>
                </div>
            </div>
            <div class="col-md-3">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.4.1 On-net</label>
                    {{ form.chamadas_on_net }}
                </div>
            </div>
            <div class="col-md-3">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.4.2 Off-net</label>
                    {{ form.chamadas_off_net_nacional }}
                </div>
            </div>
            <div class="col-md-3">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.4.2.1 Rede Fixa</label>
                    {{ form.chamadas_rede_fixa }}
                </div>
            </div>
        </div>
        
        <!-- Internacional -->
        <h6 style="color: var(--binance-warning);">5.4.3 Chamadas Internacionais</h6>
        <div class="row">
            <div class="col-md-4">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.4.3 Total Internacional</label>
                    {{ form.chamadas_internacional_total }}
                    <small class="form-text text-muted">Calculado</small>
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.4.3.1 CEDEAO</label>
                    {{ form.chamadas_cedeao }}
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.4.3.2 PALOP</label>
                    {{ form.chamadas_palop }}
                </div>
            </div>
        </div>
        <div class="row mt-3">
            <div class="col-md-4">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.4.3.3 CPLP</label>
                    {{ form.chamadas_cplp }}
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.4.3.4 Resto África</label>
                    {{ form.chamadas_resto_africa }}
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.4.3.5 Resto Mundo</label>
                    {{ form.chamadas_resto_mundo }}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- SEÇÃO 5.5: OUTROS SERVIÇOS -->
<div class="platform-card mb-4">
    <div class="card-header">
        <h4 class="card-title">
            <i class="fas fa-ellipsis-h me-2"></i>
            5.5 Outros Serviços
        </h4>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.5.1 Números Curtos</label>
                    {{ form.numeros_curtos }}
                    <small class="form-text text-muted">Opcional - deixe vazio se NA</small>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group-questionario">
                    <label class="form-label-questionario">5.5.2 MMS Total</label>
                    {{ form.mms_total }}
                    <small class="form-text text-muted">Opcional - deixe vazio se NA</small>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Resumo de Totalizadores -->
<div class="platform-card mb-4">
    <div class="card-header">
        <h4 class="card-title">
            <i class="fas fa-calculator me-2"></i>
            Resumo de Totais
        </h4>
    </div>
    <div class="card-body">
        <div class="row text-center">
            <div class="col-md-3">
                <div class="total-summary-item">
                    <i class="fas fa-database fa-2x mb-2" style="color: var(--binance-yellow);"></i>
                    <h6>Total Dados</h6>
                    <p class="total-value" id="total-dados-gb">0 GB</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="total-summary-item">
                    <i class="fas fa-sms fa-2x mb-2" style="color: var(--binance-success);"></i>
                    <h6>Total SMS</h6>
                    <p class="total-value" id="total-sms">0</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="total-summary-item">
                    <i class="fas fa-phone-alt fa-2x mb-2" style="color: var(--binance-info);"></i>
                    <h6>Total Minutos</h6>
                    <p class="total-value" id="total-minutos">0</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="total-summary-item">
                    <i class="fas fa-phone-volume fa-2x mb-2" style="color: var(--binance-warning);"></i>
                    <h6>Total Chamadas</h6>
                    <p class="total-value" id="total-chamadas">0</p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block submit_text %}{% if form.instance.pk %}Atualizar{% else %}Criar{% endif %} Tráfego Originado{% endblock %}

{% block form_info %}
<div class="platform-card mt-4">
    <div class="card-header">
        <h3 class="card-title">
            <i class="fas fa-info-circle me-2"></i>
            Instruções de Preenchimento
        </h3>
    </div>
    <div class="card-body">
        <div class="alert-questionario alert-questionario-info">
            <i class="fas fa-lightbulb"></i>
            <div>
                <strong>Notas Importantes:</strong>
                <ul class="mb-0 mt-2">
                    <li><strong>Volumes de Dados:</strong> Sempre em MBytes (MB)</li>
                    <li><strong>Sessões:</strong> Número total de sessões de dados</li>
                    <li><strong>SMS/Chamadas:</strong> Quantidade total</li>
                    <li><strong>Voz:</strong> Volume em minutos</li>
                    <li><strong>Totais:</strong> São calculados automaticamente</li>
                    <li><strong>Regiões:</strong> CEDEAO, PALOP, CPLP, Resto África, Resto Mundo</li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block form_js %}
<script src="{% static 'js/trafego_originado_form_validation.js' %}"></script>
{% endblock %}